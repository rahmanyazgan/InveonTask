@model List<WebUI.Models.ProductViewModel>

@{
    ViewBag.Title = "Ürünler";
    Layout = "~/Views/Shared/Layout.cshtml";

    Model.AddRange(Model);
    Model.AddRange(Model);
    Model.AddRange(Model);

    int pageSize = 10;

    int currentPage = Request.QueryString["page"] != null ? Convert.ToInt32(Request.QueryString["page"]) : 1;
    int totalItems = Model.Count();
    int totalPages = (int)Math.Ceiling((double)totalItems / pageSize);
    int startIndex = (currentPage - 1) * pageSize;
    int endIndex = Math.Min(startIndex + pageSize, totalItems);

    int startPage = Math.Max(1, currentPage - 2);
    int endPage = Math.Min(totalPages, currentPage + 2);
}

@if (Model != null && Model.Any())
{
    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead class="thead-dark">
                <tr>
                    <th style="width: 100px;">Ürün</th>
                    <th style="width: 100px; text-align: center;">Açıklama</th>
                    <th style="width: 100px; text-align: center;">Adet</th>
                    <th style="width: 120px; text-align: center;">Fiyat</th>
                    <th style="width: 120px; text-align: center;">Tarih</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Skip(startIndex).Take(pageSize))
                {
                    <tr>
                        <td>@item.Name</td>
                        <td style="text-align: center;">@item.Description</td>
                        <td style="text-align: center;">@item.Quantity</td>
                        <td style="text-align: center;">@item.Price.ToString("C0")</td>
                        <td style="text-align: center;">@item.CreatedDate.Value.ToString("dd.MM.yyyy HH:mm:ss")</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
            <!-- İlk sayfa linki -->
            <li class="page-item @(currentPage == 1 ? "disabled" : "")">
                <a class="page-link" href="@(currentPage == 1 ? "#" : Url.Action("Index", new { page = currentPage - 1 }))" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>

            <!-- Sayfa numaraları -->
            @for (int i = startPage; i <= endPage; i++)
            {
                <li class="page-item @(i == currentPage ? "active" : "")">
                    <a class="page-link" href="@Url.Action("Index", new { page = i })">@i</a>
                </li>
            }

            <!-- Son sayfa linki -->
            <li class="page-item @(currentPage == totalPages ? "disabled" : "")">
                <a class="page-link" href="@(currentPage == totalPages ? "#" : Url.Action("Index", new { page = currentPage + 1 }))" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                </a>
            </li>
        </ul>

        <!-- Sayfa bilgisi -->
        <div class="text-center mt-2">
            <small class="text-muted">
                Toplam @totalItems kayıt, Sayfa @currentPage / @totalPages
                (@(startIndex + 1) - @endIndex arası gösteriliyor)
            </small>
        </div>
    </nav>

}
else
{
    <div class="alert alert-info">
        <p>Henüz ürün bulunmamaktadır.</p>
    </div>
}
